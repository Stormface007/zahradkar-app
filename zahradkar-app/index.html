<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zahrádkářský systém</title>
  <link rel="stylesheet" href="style.css"/>
  <script src="script.js" defer></script>
</head>
<body>
  <!-- Indikátor akce -->
  <div id="actionIndicator" class="action-indicator">
    <img src="img/Plodina_mrkev .png" alt="Vizualizace akce"/>
  </div>

  <!-- Přihlašovací formulář -->
  <div id="loginDiv">
    <img src="img/icon_trimmed_transparent_customcolor.png" alt="Logo" class="logo-small"/>
    <input type="text" id="username" placeholder="Uživatelské jméno"/>
    <input type="password" id="password" placeholder="Heslo"/>
    <button onclick="login()">Přihlásit</button>
    <div id="loginMsg"></div>
  </div>

  <!-- Hlavní aplikace -->
  <div id="appDiv" style="display:none;">
    <div class="top-panel">
      <div id="weatherContainer" class="toolbar-weather">
        <img id="weatherIcon" alt="Počasí"/>
        <div id="weatherTemp">–</div>
      </div>
      <img id="exitIcon" class="icon-button" src="img/Exit.png" alt="Odhlásit se" onclick="logout()"/>
      <img id="userIcon" class="icon-button" src="img/User.png" alt="Uživatel"/>
    </div>

    <div class="table-actions">
      <button onclick="deleteSelected()">🗑️ Smazat označené</button>
    </div>
    <div class="table-container">
      <table id="zahonyTable">
        <thead>
          <tr><th></th><th>Název záhonu</th><th>Velikost</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div id="pridatZahonForm">
  <h3>Přidat nový záhon</h3>
  <label>Název: <input type="text" id="newNazev"/></label><br>
  <label>Délka (m): <input type="number" id="newDelka"/></label><br>
  <label>Šířka (m): <input type="number" id="newSirka"/></label><br>
  
  <!-- ✅ VÝBĚR TYPU PLOCHY -->
  <div style="margin: 10px 0;">
    <strong>Typ plochy:</strong><br>
    <label style="display: block; margin: 5px 0;">
      <input type="radio" name="typPlochy" value="zahon" checked> 🌾 Záhon
    </label>
    <label style="display: block; margin: 5px 0;">
      <input type="radio" name="typPlochy" value="sklenik"> 🏠 Skleník
    </label>
    <label style="display: block; margin: 5px 0;">
      <input type="radio" name="typPlochy" value="nadoba"> 🪴 Nádoba (truhlík/pytel)
    </label>
  </div>
  
  <button onclick="addZahon()">Přidat</button>
</div>

  </div>

  <!-- MODÁLNÍ OKNO pro editaci záhonu a akce -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <!-- Boční panel ikon -->
      <div class="side-icons">
        <img id="icon-mereni"    class="side-icon" src="img/mereni.png"    alt="Měření"    onclick="onIconClick('mereni')"/>
        <img id="icon-seti"      class="side-icon" src="img/sklizen.png"      alt="Setí"      onclick="onIconClick('seti')"/>
        <img id="icon-hnojeni"   class="side-icon" src="img/hnojeni.png"   alt="Hnojení"   onclick="onIconClick('hnojeni')"/>
        <img id="icon-analyza"   class="side-icon" src="img/analyza.png"   alt="Analýza"   onclick="onIconClick('analyza')"/>
        <img id="icon-nastaveni" class="side-icon" src="img/nastaveni.png" alt="Nastavení" onclick="onIconClick('nastaveni')"/>
      </div>

      <div class="modal-body">
        <div id="nazevZahonu" class="modal-zahon-name"></div>
        
        <!-- Základní editace záhonu -->
        <div id="modalViewDefault">
          <h3>Úprava záhonu</h3>
          <input type="text" id="editNazev" placeholder="Název záhonu"/>
          <div class="dimensions">
            <input type="number" id="editDelka" placeholder="Délka (m)" min="0" oninput="updatePlocha()"/>
            <input type="number" id="editSirka" placeholder="Šířka (m)" min="0" oninput="updatePlocha()"/>
          </div>
          <div class="plocha">Plocha: <span id="vypocetPlochy">0</span> </div>
          <div id="zahonVizualizace">
            <div id="canvasContainer">
             <canvas id="zahonCanvas" style="width: 100%; height: 100%;" onclick="openZoom()"></canvas>
            </div>
          </div>
          <img src="img/Safe.png"    alt="Uložit" class="modal-btn" onclick="saveZahon()"/>
          <img src="img/Goback .png"  alt="Zavřít" class="modal-btn" onclick="closeModal()"/>
        </div>

       <!-- Formulář událostí / analýzy -->
<div id="modalViewUdalost" style="display:none;">
  <div id="udalostFormContainer">
    <label for="udalostDatum">Datum setí:</label>
    <input type="date" id="udalostDatum"/>
    <label for="plodinaSelect">Plodina:</label>
    <select id="plodinaSelect"></select>
    <!-- SEM PŘIDEJ BLOK -->
    <div id="doporuceniHnojeni" style="font-size:0.95em;color:#33691e; margin-top:5px;"></div>
    <!-- zbytek formuláře: -->
    <input id="udalostVynos" ...>
    <!-- další pole -->
  </div>
</div>

        </div>
      </div>
    </div>
  </div>

  <!-- MODÁLNÍ OKNO PRO ZVĚTŠENÝ NÁHLED -->
  <div id="zoomModal" class="modal">
    <div class="modal-content" style="padding: 20px; max-width: 800px;">
      <h3>Zvětšený náhled záhonu</h3>
      <canvas id="zoomCanvas" width="600" height="400"></canvas>
      <br>
      <button onclick="closeZoomModal()">Zavřít</button>
    </div>
  </div>
<!-- MODÁLNÍ OKNO PRO DETAILNÍ DOPORUČENÍ -->
<div id="modalDetailDoporuceni" class="modal" style="display:none;">
  <div class="modal-content" style="max-width: 800px; max-height: 90vh; overflow-y: auto;">
    <h3 style="margin-top:0;">📋 Detailní doporučení hnojení a mikroprvků</h3>
    
    <!-- ✅ PŘEPÍNAČ PŘÍSTUPU -->
    <div style="background: #f5f5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
      <div style="margin-bottom: 10px;">
        <strong>Typ plochy:</strong> 
        <span id="typPlochyInfo"></span>
      </div>
      
      <div>
        <strong>Přístup k hnojení:</strong>
        <div style="display: flex; gap: 15px; margin-top: 8px;">
          <label style="cursor: pointer;">
            <input type="radio" name="pristupModal" value="chemicky" onchange="zmenPristupModal('chemicky')">
            🧪 Chemicky
          </label>
          <label style="cursor: pointer;">
            <input type="radio" name="pristupModal" value="kombinace" checked onchange="zmenPristupModal('kombinace')">
            🌿 Kombinovaně
          </label>
          <label style="cursor: pointer;">
            <input type="radio" name="pristupModal" value="organicky" onchange="zmenPristupModal('organicky')">
            🌱 Organicky
          </label>
        </div>
      </div>
    </div>
    
    <!-- OBSAH DOPORUČENÍ -->
    <div id="detailDoporuceniObsah" style="line-height: 1.6;">
      <!-- Obsah se dynamicky načte -->
    </div>
    
    <br>
    <button onclick="zavriDetailDoporuceni()" style="padding: 10px 20px;">Zavřít</button>
  </div>
</div>

</body>
</html>
