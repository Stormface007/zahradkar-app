function showUdalostForm(typ) {
  document.getElementById("modalViewDefault").style.display = "none";
  const uv = document.getElementById("modalViewUdalost");
  uv.classList.remove("analysis");
  uv.style.display = "block";

  // ZOBRAZ ikonu uložit v headeru
  const saveIcon = document.getElementById("headerSaveIcon");
  if (saveIcon) saveIcon.style.display = "block";

  const c = document.getElementById("udalostFormContainer");
  if (!c) return;

  // === HNOJENÍ ===
  if (typ === "hnojeni") {
    window.typAkce = "hnojeni";

    c.innerHTML = `
      <div class="udalost-row">
        <input type="date" id="hnojeniDatum" class="udalost-input"/>
      </div>

      <div class="udalost-row">
        <select id="hnojivoSelect" class="udalost-input">
          <option value="">– vyber hnojivo –</option>
        </select>
      </div>

      <div class="udalost-row">
        <input type="number" id="hnojeniMnozstvi" class="udalost-input" placeholder="Množství (kg)"/>
      </div>

      <div id="hnojeniHistory" class="hnojeni-history">
        <em>Načítám historii...</em>
      </div>
    `;

    const datumInput = document.getElementById("hnojeniDatum");
    if (datumInput && !window.editMode) {
      datumInput.value = todayForInput();
    }

    if (!window.editMode) {
      loadHnojiva();
    }
    zobrazHnojeniHistory();
    return;
  }

  // === SETÍ / SKLIZEŇ (PLODINA) ===
  if (typ === "plodina") {
    c.innerHTML = `
      <div class="typAkceBtns">
        <button type="button" id="btnSeti"
                class="typ-akce-btn active"
                onclick="changeTypAkce('seti')">Setí</button>
        <button type="button" id="btnSklizen"
                class="typ-akce-btn"
                onclick="changeTypAkce('sklizen')">Sklizeň</button>
      </div>

      <div class="udalost-row">
        <input type="date" id="udalostDatum" class="udalost-input"/>
      </div>

      <div class="udalost-row">
        <select id="plodinaSelect" class="udalost-input">
          <option value="">– vyber plodinu –</option>
        </select>
      </div>

      <div class="udalost-row" id="vynosRow">
        <input type="number" id="udalostVynos" class="udalost-input" placeholder="Výnos (kg)"/>
      </div>

      <div id="udalostHistory" class="hnojeni-history">
        <em>Načítám historii...</em>
      </div>
    `;

    const datumInput = document.getElementById("udalostDatum");
    if (datumInput && !window.editMode) {
      datumInput.value = todayForInput();
    }

    window.typAkce = "seti";
    changeTypAkce("seti");

    naplnPlodinySelect?.();
    zobrazSetiSklizenHistory?.();
  }
}
